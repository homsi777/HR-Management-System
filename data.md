# الدليل التشريحي الشامل لنظام إدارة الموارد البشرية (HR Management System)

هذا الملف هو المرجع الأساسي والوحيد لفهم آلية عمل النظام، تفاصيل البيانات في كل بطاقة، المعادلات الرياضية، ورحلة البيانات داخل المشروع.

---

## الفصل الأول: رحلة الموظف (The Employee Journey)
هذا القسم يشرح القصة الكاملة لدورة حياة الموظف داخل النظام، من لحظة تقديم الطلب حتى استلام الراتب أو إنهاء الخدمة.

### 1. مرحلة التوظيف (The Recruitment Phase)
تبدأ الرحلة في قسم **"التوظيف"**.
*   **بطاقة طلب التوظيف (Application Card):**
    *   **البيانات الشخصية:** الاسم الكامل، الهاتف، العنوان، تاريخ الميلاد، الحالة الاجتماعية.
    *   **الخبرات:** قائمة ديناميكية تحتوي على (المسمى الوظيفي السابق، الشركة، مدة العمل، المسؤوليات).
    *   **المؤهلات:** النصوص التفصيلية للشهادات والدورات التدريبية.
    *   **التفرغ:** (دوام كامل / جزئي / حر).
    *   **المرفقات:** السيرة الذاتية (ملف)، الصور الشخصية وصور الهوية (يتم التقاطها عبر الكاميرا أو رفعها).
    *   **الحالة:** (قيد الانتظار -> مقابلة -> مقبول / مرفوض).

*   **لحظة القبول (The Acceptance):**
    *   عند تغيير الحالة إلى **"مقبول"**، لا ينتهي الأمر هنا.
    *   يظهر **"معالج استكمال البيانات"** إجبارياً، لأن طلب التوظيف لا يحتوي على (الراتب، الفرع، مواعيد الدوام).
    *   يقوم المسؤول بتحديد: الفرع، القسم، المسمى الوظيفي، الراتب المتفق عليه، ونظام الدوام.
    *   بمجرد الحفظ، يقوم النظام **تلقائياً** بإنشاء سجل جديد في قسم "الموظفين" وربطه بطلب التوظيف الأصلي.

### 2. مرحلة التعيين والبطاقة الوظيفية (Employee Profile)
ينتقل الشخص الآن إلى قسم **"الموظفين"**. بطاقة الموظف هي "القلب النابض" للنظام وتحتوي على:

*   **التبويب الأول: المعلومات الشخصية:**
    *   الاسم، الكود الوظيفي (يولد تلقائياً)، الرقم الوطني، الهاتف، العنوان.
    *   الصور (الشخصية، الهوية وجه وخلف).

*   **التبويب الثاني: البيانات المالية (محرك الرواتب):**
    *   **نوع الدوام (Payment Type):**
        *   *راتب شهري:* مبلغ ثابت كل شهر بغض النظر عن عدد الأيام (مع خيار خصم الغياب).
        *   *راتب أسبوعي:* مبلغ ثابت كل أسبوع.
        *   *نظام ساعات:* يحاسب الموظف بناءً على (عدد ساعات العمل × سعر الساعة).
    *   **العملة:** تحديد عملة الراتب (دولار، ليرة سوري، ليرة تركي).
    *   **ساعات العمل اليومية المقررة:** الرقم المرجعي (مثلاً 8 ساعات). ما عمله الموظف أقل منه يعتبر "أساسي"، وما زاد عنه يعتبر "إضافي".
    *   **المعدلات:**
        *   *سعر الساعة:* يستخدم لحساب الخصم أو الإضافي للموظف الشهري.
        *   *مضاعف الإضافي:* (مثلاً 1.5) يعني ساعة الإضافي تحسب بساعة ونصف.
        *   *خصم التأخير:* قيمة دقيقة التأخير (أو تركها 0 ليحسبها النظام تلقائياً من الراتب).
    *   **خيار "احتساب 30 يوم":** إذا تم تفعيله، يتم اعتبار الشهر 30 يوماً مدفوعاً بالكامل ولا يخصم إلا الغياب الفعلي.

*   **التبويب الثالث: الدوام والورديات:**
    *   **المواعيد:** وقت الدخول، وقت الخروج.
    *   **فترات السماح:** وقت انتهاء الدخول (التأخير)، وقت انتهاء الخروج (الإضافي).
    *   **أيام العمل:** تحديد أيام الأسبوع التي يعمل بها الموظف (يؤثر على حساب الغياب).
    *   **جهاز البصمة:** ربط الموظف برقم المعرف (Biometric ID) الموجود في جهاز البصمة.

### 3. مرحلة العمل اليومي (Operations)
*   **تسجيل الحضور:**
    *   يتم آلياً عبر أجهزة البصمة، أو يدوياً من قبل المسؤول.
    *   أي بصمة تأتي من الجهاز لموظف غير مسجل، تذهب إلى **"سجلات غير مطابقة"** ليقوم المسؤول بمعالجتها.
*   **الإجازات:**
    *   يقدم الموظف طلب إجازة.
    *   يختار النوع (سنوية، مرضية، طارئة، بلا راتب).
    *   خيار **"خصم من الراتب"**: إذا تم تفعيله، سيقوم النظام بخصم أيام الإجازة من الراتب النهائي تلقائياً.
*   **السلف:** طلب سلفة مالية، عند الموافقة عليها تبقى "معلقة" حتى لحظة تسليم الراتب ليتم خصمها.

---

## الفصل الثاني: تشريح الأقسام (Module Anatomy)

### 1. قسم الرواتب (Payroll Module)
هذا هو "العقل الحسابي" للنظام. كيف يخرج الرقم النهائي؟

*   **المعادلة الكبرى:**
    `الصافي = (الأساسي + الإضافي + المكافآت) - (الخصميات + التأخير + السلف)`

*   **التفاصيل الدقيقة:**
    *   **الراتب الأساسي المنجز:**
        *   للموظف الشهري: هو الراتب الكامل (إلا إذا كان هناك خصم غياب).
        *   للموظف الساعي: `مجموع الساعات العادية × سعر الساعة`.
    *   **الإضافي (Overtime):**
        *   يحسب النظام الفرق بين (ساعات الحضور الفعلية) و (ساعات العمل المقررة في بطاقة الموظف).
        *   القيمة = `ساعات الزيادة × سعر الساعة × مضاعف الإضافي`.
    *   **التأخير:**
        *   يحسب الدقائق بعد "وقت انتهاء الدخول".
        *   القيمة = `دقائق التأخير × سعر دقيقة التأخير`.
    *   **الغياب:**
        *   يعد النظام الأيام التي لم يسجل فيها الموظف حضوراً (وليست عطلة أسبوعية وليست إجازة مدفوعة).
        *   يخصم قيمة هذه الأيام من الراتب.

### 2. قسم العملاء (Clients CRM)
نظام مصغر لإدارة العلاقات:
*   **بطاقة العميل:** الاسم، الهاتف، العنوان، المجال، التقييم (نجوم)، الاهتمامات (Tags).
*   **المهام (Tasks):** يمكن إضافة مهام مرتبطة بكل عميل (مثلاً: "متابعة عرض سعر").
*   **دورة حياة المهمة:** (قيد الانتظار -> قيد التنفيذ -> مكتملة -> ملغاة).

### 3. قسم المناديب (Representatives)
مخصص للموظفين الذين يعملون خارج الشركة:
*   يتم اختيار موظف موجود مسبقاً لتحويله إلى مندوب.
*   **بيانات إضافية:** نوع السيارة، رقم اللوحة، المنطقة الجغرافية.
*   **الميزة:** يظهرون في لوحة التحكم بشكل منفصل لتسجيل خروجهم/عودتهم يدوياً.

### 4. قسم الصيانة (Maintenance)
مخصص للفنيين الذين يجمعون مبالغ نقدية:
*   يتم تسجيل "سجل صيانة" يحتوي على: المبلغ المستلم، العملة، والتاريخ.
*   يظهر تقرير يوضح إجمالي المبالغ التي بحوزة كل فني.

### 5. قسم الأمانات (Custody)
*   إدارة العهد العينية (لابتوب، سيارة، مفاتيح).
*   يتم تسجيل: اسم الغرض، تاريخ التسليم، وحالته.

---

## الفصل الثالث: الإعدادات والبنية التحتية

### 1. معالج التثبيت (Setup Wizard)
يظهر مرة واحدة عند تشغيل النظام لأول مرة، ويجبر المستخدم على إدخال الهيكل الأساسي:
1.  **التفعيل:** إدخال كود الترخيص.
2.  **المدير:** إنشاء حساب Admin.
3.  **الشركة:** اسم المؤسسة.
4.  **الهيكل:** إنشاء أول (فرع -> قسم -> مسمى وظيفي).

### 2. أجهزة البصمة (Devices)
*   يدعم النظام بروتوكولات ZKTeco.
*   يمكن سحب البيانات يدوياً أو انتظار الدفع التلقائي (Push Data) على المنفذ 5005.

### 3. بوابة الرسائل (SMS)
*   تتيح إرسال رسائل نصية (SMS) للموظفين (عند استلام الراتب، عند التأخير) أو للمتقدمين للعمل (عند القبول).
*   تتطلب مودم GSM متصل بمنفذ COM.

---

## ملخص العمليات الحسابية (Cheatsheet)

| الحالة | طريقة الحساب |
| :--- | :--- |
| **العمل الإضافي** | `(ساعات العمل الفعلي - الساعات المقررة) × (سعر الساعة × المضاعف)` |
| **ساعات العمل الأساسي** | `الأقل بين (ساعات العمل الفعلي) و (الساعات المقررة)` |
| **التأخير** | `(وقت البصمة - وقت السماح) × سعر الدقيقة` |
| **الغياب (راتب شهري)** | `(الراتب / 30) × أيام الغياب` (في حال تفعيل خيار 30 يوم) |
